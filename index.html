<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>MODERN CROSS GAME BY ANSHUHIM</title>
    <style>
        :root{
            --bg: #0a0b10;
            --card: #151921;
            --cyan: #00f2ff;
            --purple: #bc13fe;
            --main: #e0e6ed;
            --dim: #94a3b8;
            --transition: all .22s cubic-bezier(.4,0,.2,1);
        }
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
            background:linear-gradient(135deg,#0a0b10 0%,#1a1c2c 100%);
            color:var(--main);
            min-height:100vh;display:flex;flex-direction:column;align-items:center;
        }

        header{width:100%;max-width:700px;padding:1rem;display:flex;align-items:center;gap:12px;justify-content:center}
        .logo{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--cyan),var(--purple));font-weight:800}
        header h1{font-size:1.05rem;letter-spacing:1px;text-transform:uppercase}

        main{width:100%;max-width:720px;padding:1rem;display:flex;flex-direction:column;gap:1rem}
        .card{background:var(--card);border-radius:18px;padding:18px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 10px 30px rgba(0,0,0,.5)}

        /* Mode & difficulty */
        .mode-row{display:flex;gap:8px;margin-bottom:12px}
        .mode-btn{flex:1;padding:8px;border-radius:10px;border:none;background:transparent;color:var(--dim);font-weight:700;cursor:pointer;transition:var(--transition)}
        .mode-btn.active{background:var(--purple);color:#fff;box-shadow:0 6px 18px rgba(188,19,254,.12)}
        .difficulty{display:flex;gap:8px;margin-top:10px;align-items:center}
        .diff-btn{padding:6px 10px;border-radius:10px;border:none;background:transparent;color:var(--dim);cursor:pointer;font-weight:700}
        .diff-btn.active{background:var(--cyan);color:#031018;box-shadow:0 6px 18px rgba(0,242,255,.08)}

        .status{text-align:center;margin-bottom:8px}
        .status .text{font-weight:800;font-size:1.05rem;margin-bottom:6px}
        .indicator{height:4px;width:56px;margin:0 auto;background:var(--cyan);border-radius:3px;box-shadow:0 0 10px var(--cyan);transition:var(--transition)}
        .turn-o .indicator{background:var(--purple);box-shadow:0 0 10px var(--purple)}

        .board{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:95%;aspect-ratio:1/1;margin:10px auto;padding:10px;background:rgba(0,242,255,0.03);border-radius:14px;border:1px solid rgba(0,242,255,0.06)}
        .cell{background:#1a1c2c;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:2.2rem;font-weight:900;cursor:pointer;border:1px solid rgba(255,255,255,.03);user-select:none;min-height:60px;transition:var(--transition)}
        .cell.x{color:var(--cyan);text-shadow:0 0 12px rgba(0,242,255,.35)}
        .cell.o{color:var(--purple);text-shadow:0 0 12px rgba(188,19,254,.35)}
        .cell.winner{background:rgba(255,255,255,0.06);animation:pulse 1s infinite alternate}

        @keyframes pulse{from{box-shadow:0 0 5px currentColor}to{box-shadow:0 0 20px currentColor}}

        .controls{display:flex;gap:10px;margin-top:6px}
        .btn{flex:1;padding:11px;border-radius:12px;border:none;font-weight:800;cursor:pointer}
        .btn.restart{background:#2d3446;color:#fff}
        .btn.reset{background:var(--cyan);color:#041019}

        .scores{display:flex;justify-content:space-between;background:var(--card);padding:12px;border-radius:12px;margin-top:12px}
        .score-item{text-align:center;flex:1}
        .score-label{font-size:.65rem;color:var(--dim);text-transform:uppercase}
        .score-val{font-size:1.1rem;font-weight:800}
        .val-x{color:var(--cyan)}
        .val-o{color:var(--purple)}

        footer{padding:18px;text-align:center;color:var(--dim);font-size:.8rem}

        /* toast & modal */
        #toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%);background:rgba(0,0,0,0.85);color:#fff;padding:8px 14px;border-radius:18px;display:none;z-index:2000}
        .modal-back{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;z-index:2500}
        .modal-back.show{display:flex}
        .modal{background:var(--card);padding:18px;border-radius:12px;width:min(460px,92%);text-align:center;border:1px solid rgba(255,255,255,.03)}
        .modal h2{font-size:1.15rem;margin-bottom:6px}
        .modal p{color:var(--dim);margin-bottom:12px}
        .modal .actions{display:flex;gap:8px;justify-content:center}

        @media(min-width:768px){main{max-width:900px;display:grid;grid-template-columns:1fr 320px;gap:16px}}
    </style>
</head>
<body class="turn-x">

    <header>
        <div class="logo">‚úï‚≠ï</div>
        <h1>MODERN CROSS GAME BY ANSHUHIM</h1>
    </header>

    <div id="toast" role="status" aria-live="polite">Message</div>

    <main>
        <section class="card">
            <div style="display:flex;flex-direction:column">
                <div class="mode-row" role="tablist" aria-label="Game Modes">
                    <button id="btn-pvp" class="mode-btn active" onclick="setMode('pvp')" aria-pressed="true">Local P vs P</button>
                    <button id="btn-ai" class="mode-btn" onclick="setMode('ai')" aria-pressed="false">Vs Computer</button>
                </div>

                <div id="ai-controls" style="display:none">
                    <div style="font-size:0.85rem;color:var(--dim);margin-bottom:6px">AI Difficulty</div>
                    <div class="difficulty" role="group" aria-label="AI Difficulty">
                        <button class="diff-btn" id="diff-easy" onclick="setAIDifficulty('easy')">Easy</button>
                        <button class="diff-btn active" id="diff-medium" onclick="setAIDifficulty('medium')">Medium</button>
                        <button class="diff-btn" id="diff-hard" onclick="setAIDifficulty('hard')">Hard</button>
                    </div>
                </div>

                <div class="status" aria-live="polite">
                    <div class="text" id="statusText">üë§ 1Ô∏è‚É£ Player 1 ‚Äî X's Turn</div>
                    <div class="indicator"></div>
                </div>

                <div class="board" id="board" aria-label="Tic Tac Toe board">
                    <div class="cell" data-index="0" tabindex="0" role="button" aria-label="cell 0"></div>
                    <div class="cell" data-index="1" tabindex="0" role="button" aria-label="cell 1"></div>
                    <div class="cell" data-index="2" tabindex="0" role="button" aria-label="cell 2"></div>
                    <div class="cell" data-index="3" tabindex="0" role="button" aria-label="cell 3"></div>
                    <div class="cell" data-index="4" tabindex="0" role="button" aria-label="cell 4"></div>
                    <div class="cell" data-index="5" tabindex="0" role="button" aria-label="cell 5"></div>
                    <div class="cell" data-index="6" tabindex="0" role="button" aria-label="cell 6"></div>
                    <div class="cell" data-index="7" tabindex="0" role="button" aria-label="cell 7"></div>
                    <div class="cell" data-index="8" tabindex="0" role="button" aria-label="cell 8"></div>
                </div>

                <div class="controls">
                    <button class="btn restart" onclick="restartGame()">Restart Round</button>
                    <button class="btn reset" onclick="newGame()">Reset Scores</button>
                </div>
            </div>
        </section>

        <aside>
            <div class="card scores">
                <div class="score-item">
                    <div class="score-label">Player X</div>
                    <div class="score-val val-x" id="scoreX">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Draws</div>
                    <div class="score-val" id="scoreDraws">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Player O</div>
                    <div class="score-val val-o" id="scoreO">0</div>
                </div>
            </div>

            <div style="margin-top:12px" class="card">
                <div style="font-weight:800;margin-bottom:8px">How to play</div>
                <div style="color:var(--dim);font-size:0.92rem;line-height:1.4">
                    - X always starts.<br>
                    - In PvP: Player 1 is X (1Ô∏è‚É£) and Player 2 is O (2Ô∏è‚É£).<br>
                    - In Vs Computer: you are üë§ (X) and AI is ü§ñ (O).<br>
                    - Choose difficulty: Easy (random), Medium (smart), Hard (unbeatable).
                </div>
            </div>
        </aside>
    </main>

    <footer>
        <div>Website created by Himanshu ‚Äì anshuhim.com</div>
    </footer>

    <!-- Modal -->
    <div class="modal-back" id="modalBackdrop" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="modal" role="document">
            <h2 id="modalTitle">Game Over</h2>
            <p id="modalMsg">Result</p>
            <div class="actions">
                <button class="btn restart" id="modalRestart">Restart Round</button>
                <button class="btn reset" id="modalReset">Reset Scores</button>
                <button class="btn" id="modalClose" style="background:#2d3446;color:#fff">Close</button>
            </div>
        </div>
    </div>

    <script>
    /**********************
     * Modern Cross Game
     * - Modes: Local PvP, Vs Computer
     * - AI difficulty: easy / medium / hard (minimax)
     * - Emoji-based status lines
     * - Simple generated sounds (no external files)
     **********************/

    // State
    let boardState = Array(9).fill("");
    let currentPlayer = "X";
    let gameActive = true;
    let gameMode = "pvp"; // 'pvp' | 'ai'
    let aiDifficulty = "medium"; // easy | medium | hard
    let scores = { X: 0, O: 0, Draws: 0 };

    // DOM
    const statusText = document.getElementById('statusText');
    const indicator = document.querySelector('.indicator');
    const cells = document.querySelectorAll('.cell');
    const scoreXEl = document.getElementById('scoreX');
    const scoreOEl = document.getElementById('scoreO');
    const scoreDrawsEl = document.getElementById('scoreDraws');
    const toast = document.getElementById('toast');
    const aiControls = document.getElementById('ai-controls');

    // Modal
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalTitle = document.getElementById('modalTitle');
    const modalMsg = document.getElementById('modalMsg');
    document.getElementById('modalRestart').addEventListener('click', () => restartGame());
    document.getElementById('modalReset').addEventListener('click', () => newGame());
    document.getElementById('modalClose').addEventListener('click', () => hideModal());
    modalBackdrop.addEventListener('click', (e) => { if (e.target === modalBackdrop) hideModal(); });

    // Winning patterns
    const winConditions = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

    // Audio (WebAudio simple beeps) - no files required
    let audioCtx = null;
    let audioInitialized = false;
    function initAudio() {
        if (audioInitialized) return;
        try {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            audioInitialized = true;
        } catch(e) {
            console.warn("Audio not supported", e);
            audioInitialized = false;
        }
    }
    // resume audio on first interaction (some browsers require)
    window.addEventListener('pointerdown', initAudio, {once:true});

    function playTone(freq=440, time=0.06, type='sine', gain=0.12) {
        if (!audioInitialized) return;
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type;
        o.frequency.value = freq;
        g.gain.value = gain;
        o.connect(g);
        g.connect(audioCtx.destination);
        o.start();
        g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + time);
        setTimeout(()=>{ try{ o.stop(); }catch(e){} }, time*1000 + 20);
    }
    function playMoveSound(){ playTone(880,0.06,'sine',0.08) }
    function playWinSound(){ playTone(520,0.18,'sawtooth',0.16); setTimeout(()=>playTone(780,0.14,'triangle',0.12),150) }
    function playDrawSound(){ playTone(300,0.16,'sine',0.11); setTimeout(()=>playTone(450,0.12,'sine',0.09),140) }

    // Helpers
    function showToast(msg, ms=1500){
        toast.innerText = msg;
        toast.style.display = 'block';
        clearTimeout(toast._t);
        toast._t = setTimeout(()=> toast.style.display='none', ms);
    }

    // Initial render
    updateScoreboard();
    updateBoardUI();
    updateStatusUI();

    // Events on cells (click + keyboard)
    cells.forEach(cell => {
        cell.addEventListener('click', () => handleCellClick(cell));
        cell.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); handleCellClick(cell); }
        });
    });

    // Mode & difficulty controls
    window.setMode = (mode) => {
        if (mode !== 'pvp' && mode !== 'ai') return;
        gameMode = mode;
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + mode).classList.add('active');
        aiControls.style.display = (mode === 'ai') ? 'block' : 'none';
        restartGame();
        showToast(mode === 'ai' ? 'Mode: Vs Computer' : 'Mode: Local PvP');
    };

    window.setAIDifficulty = (d) => {
        if (!['easy','medium','hard'].includes(d)) return;
        aiDifficulty = d;
        document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('diff-' + d).classList.add('active');
        showToast('AI: ' + d[0].toUpperCase() + d.slice(1));
    };

    // Click handler
    function handleCellClick(cell){
        if (!gameActive) return;
        const idx = Number(cell.getAttribute('data-index'));
        if (boardState[idx] !== "") return;

        // In AI mode, only allow human when it's X's turn (we assume human is X)
        if (gameMode === 'ai' && currentPlayer !== 'X') {
            showToast("Wait for the AI ü§ñ");
            return;
        }

        // Initialize audio context on user interaction if needed
        initAudio();

        makeMove(idx, true); // true => human triggered
        playMoveSound();

        // If AI mode and game still active and it's now AI's turn, trigger AI
        if (gameMode === 'ai' && gameActive && currentPlayer === 'O') {
            // small delay to feel natural
            setTimeout(() => {
                makeAIMove();
            }, 380);
        }
    }

    // Make a move by currentPlayer at index
    // humanTriggered used to differentiate sounds or analytics if needed
    function makeMove(index, humanTriggered=false){
        boardState[index] = currentPlayer;
        updateBoardUI();
        // check results before toggling currentPlayer
        const ended = checkResultAndHandle();
        if (!ended) {
            // toggle player
            currentPlayer = (currentPlayer === 'X') ? 'O' : 'X';
            updateStatusUI();
        }
    }

    // Update board visuals
    function updateBoardUI(){
        cells.forEach((c,i) => {
            c.innerText = boardState[i];
            c.className = 'cell ' + (boardState[i] ? boardState[i].toLowerCase() : '');
            if (!boardState[i]) c.classList.remove('winner');
        });
    }

    // Update status text + body class for indicator
    function updateStatusUI(){
        document.body.className = `turn-${currentPlayer.toLowerCase()}`;
        // Build emoji based status
        if (gameMode === 'pvp') {
            if (currentPlayer === 'X') {
                statusText.innerText = "üë§ 1Ô∏è‚É£ Player 1 ‚Äî X's Turn";
            } else {
                statusText.innerText = "üë§ 2Ô∏è‚É£ Player 2 ‚Äî O's Turn";
            }
        } else { // ai
            if (currentPlayer === 'X') {
                statusText.innerText = "üë§ Your Turn ‚Äî X";
            } else {
                statusText.innerText = "ü§ñ AI's Turn ‚Äî O";
            }
        }
    }

    // Check win/draw and handle end of game. Returns true if game ended.
    function checkResultAndHandle(){
        // Win check
        for (let cond of winConditions){
            const [a,b,c] = cond;
            if (boardState[a] && boardState[a] === boardState[b] && boardState[a] === boardState[c]) {
                // winner is currentPlayer (the one who just played)
                highlightLine(cond);
                scores[currentPlayer]++;
                updateScoreboard();
                gameActive = false;
                updateStatusOnEnd(`${currentPlayer} Wins!`);
                playWinSound();
                showGameOverModal(`${currentPlayer} Wins!`);
                return true;
            }
        }
        // Draw
        if (!boardState.includes("")) {
            scores.Draws++;
            updateScoreboard();
            gameActive = false;
            updateStatusOnEnd("It's a Draw!");
            playDrawSound();
            showGameOverModal("It's a Draw!");
            return true;
        }
        return false;
    }

    function highlightLine(line){
        line.forEach(i => {
            const el = document.querySelector(`.cell[data-index="${i}"]`);
            if (el) el.classList.add('winner');
        });
    }

    function updateStatusOnEnd(message){
        // show message on top + keep body class as winner side (optional)
        statusText.innerText = message;
    }

    function updateScoreboard(){
        scoreXEl.innerText = scores.X;
        scoreOEl.innerText = scores.O;
        scoreDrawsEl.innerText = scores.Draws;
    }

    // Controls
    function restartGame(){
        boardState = Array(9).fill("");
        currentPlayer = "X";
        gameActive = true;
        updateBoardUI();
        updateStatusUI();
        hideModal();
        showToast("Round restarted");
    }
    function newGame(){
        scores = { X:0, O:0, Draws:0 };
        updateScoreboard();
        restartGame();
        showToast("Scores reset");
    }
    window.restartGame = restartGame;
    window.newGame = newGame;

    // AI logic
    function makeAIMove(){
        if (!gameActive) return;
        // pick based on difficulty
        let idx = null;
        if (aiDifficulty === 'easy') {
            const avail = boardState.map((v,i)=> v===""?i:null).filter(v=>v!==null);
            idx = avail[Math.floor(Math.random()*avail.length)];
        } else if (aiDifficulty === 'medium') {
            // heuristic: win, block, center, corner, side
            idx = getWinCheck('O'); if (idx !== null) { /* win */ }
            else { idx = getWinCheck('X'); } // block
            if (idx === null) {
                if (boardState[4]==="") idx = 4;
            }
            if (idx === null) {
                const corners = [0,2,6,8].filter(i=>boardState[i]==="");
                if (corners.length) idx = corners[Math.floor(Math.random()*corners.length)];
            }
            if (idx === null) {
                for (let i=0;i<9;i++) if (boardState[i]==="") { idx = i; break; }
            }
        } else { // hard -> minimax (unbeatable)
            idx = minimaxRoot(boardState.slice(), 'O');
        }
        if (idx == null) return;
        makeMove(idx, false);
        playMoveSound();
    }

    function getWinCheck(p) {
        for (let c of winConditions) {
            const vals = [boardState[c[0]], boardState[c[1]], boardState[c[2]]];
            if (vals.filter(v => v === p).length === 2 && vals.filter(v => v === "").length === 1) {
                return c[vals.indexOf("")];
            }
        }
        return null;
    }

    // Minimax helper (for 'O' = AI maximize)
    function minimaxRoot(board, player) {
        let bestVal = -Infinity;
        let bestMove = null;
        const avail = board.map((v,i)=> v===""?i:null).filter(v=>v!==null);
        for (let i of avail){
            board[i] = player;
            let val = minimax(board, false);
            board[i] = "";
            if (val > bestVal) { bestVal = val; bestMove = i; }
        }
        return bestMove;
    }
    function minimax(board, isMaximizing) {
        // check terminal
        const winner = checkWinnerForMinimax(board);
        if (winner !== null) {
            if (winner === 'O') return 10;
            if (winner === 'X') return -10;
            if (winner === 'draw') return 0;
        }

        if (isMaximizing) {
            let best = -Infinity;
            for (let i=0;i<9;i++){
                if (board[i] === "") {
                    board[i] = 'O';
                    const val = minimax(board, false);
                    board[i] = "";
                    best = Math.max(best, val);
                }
            }
            return best;
        } else {
            let best = Infinity;
            for (let i=0;i<9;i++){
                if (board[i] === "") {
                    board[i] = 'X';
                    const val = minimax(board, true);
                    board[i] = "";
                    best = Math.min(best, val);
                }
            }
            return best;
        }
    }
    function checkWinnerForMinimax(b) {
        for (let c of winConditions){
            const [a,b1,c1] = c;
            if (b[a] && b[a] === b[b1] && b[a] === b[c1]) return b[a];
        }
        if (!b.includes("")) return 'draw';
        return null;
    }

    // Game over modal
    function showGameOverModal(message){
        modalTitle.innerText = "Game Over";
        modalMsg.innerText = message;
        modalBackdrop.classList.add('show');
        modalBackdrop.setAttribute('aria-hidden','false');
    }
    function hideModal(){
        modalBackdrop.classList.remove('show');
        modalBackdrop.setAttribute('aria-hidden','true');
    }

    // Make sure status updates on load
    document.addEventListener('DOMContentLoaded', () => {
        updateStatusUI();
    });

    // expose some for console debugging (optional)
    window.gameState = () => ({ boardState, currentPlayer, gameActive, scores, gameMode, aiDifficulty });
    </script>
</body>
</html>
